From 1b9a532107506625afc0bf0b3bf7e98886fbf1fb Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Daniel=20D=C3=ADaz?= <daniel.diaz@linaro.org>
Date: Sat, 24 Jun 2017 08:52:40 -0500
Subject: [PATCH] selftests: Use LDLIBS for proper linking of memfd
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Otherwise, this error appears:
  /tmp/ccM0iYdY.o: In function `main':
  fuse_mnt.c:(.text+0x249): undefined reference to `fuse_main_real'
  collect2: error: ld returned 1 exit status

Signed-off-by: Daniel DÃ­az <daniel.diaz@linaro.org>
---
 tools/testing/selftests/memfd/Makefile | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/tools/testing/selftests/memfd/Makefile b/tools/testing/selftests/memfd/Makefile
index 79891d0..c07af71 100644
--- a/tools/testing/selftests/memfd/Makefile
+++ b/tools/testing/selftests/memfd/Makefile
@@ -6,8 +6,8 @@ CFLAGS += -I../../../../usr/include/
 TEST_PROGS := run_fuse_test.sh
 TEST_GEN_FILES := memfd_test fuse_mnt fuse_test
 
-fuse_mnt.o: CFLAGS += $(shell pkg-config fuse --cflags)
-fuse_mnt: LDFLAGS += $(shell pkg-config fuse --libs)
+CFLAGS += $(shell pkg-config fuse --cflags)
+LDLIBS += $(shell pkg-config fuse --libs)
 
 include ../lib.mk
 
-- 
2.7.4

